
\documentclass[fleqn,12pt]{article}

\usepackage[margin=15mm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[bulgarian]{babel}
\usepackage[unicode]{hyperref}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{enumitem, hyperref}
\usepackage{upgreek}

\usepackage[dvipsnames]{xcolor}

\usepackage{amsmath}
\DeclareMathOperator{\cotg}{cotg}
\DeclareMathOperator{\LCS}{LCS}
\DeclareMathOperator{\longer}{longer}
\renewcommand{\arraystretch}{1.3}         % because math expressions

\title{Компютърни мрежи и протоколи – OSI модел. Протоколи IPv4,  IPv6, TCP, HTTP.}
\author{v1.0}
\date{8 юне 2021}

\begin{document}

\maketitle

\tableofcontents
\pagebreak

\begin{flushleft}

\section{Модели на организация на мрежовите протоколи}
\subsection{OSI модел - най-обща характеристика на нивата}
\textbf{OSI (Open Systems Interconnection)} моделът е първият опит за изграждане теоретичен модел, описващ принципите на комуникация и устройство на мрежовите протоколи.
Той е въведен от организацията \textbf{ISO}. Основна градивна единица са слоевете, като всеки слой предоставя интерфейс и услуги към слоя над него. \textf{OSI} се състои от следните 7 слоя:
\begin{enumerate}
    \item \textbf{Физическия слой} е най-ниският слой от \textbf{OSI} модела. Протоколите от този слой приемат и предават битове от едно устройство в друго, като така те отговарят за
    физическата връзка между върховете в дадена топология. Функциите на физическия слой включват:
    \begin{enumerate}
        \item \textit{синхронизация на битове} - осигурява се чрез общ clock, контролиращ изпраща и получателя.
        \item \textit{честота на изпращане на битове (bit rate control)}
        \item \textit{определяне на мрежовата топология}, т.е. дали е bus, star или mesh
        \item \textit{режим на предаване на битовете} - дали комуникацията е simplex, half-duplex или full-duplex.
        \item \textit{начин на установяване/прекъсване на връзката между устройствата}
    \end{enumerate}
    Примери за устройства от физическия слой са хъбовете, модемите и коаксиалните кабели.
    \item \textbf{Каналният слой (Data Link Layer или DLL)} се грижи за безгрешното предаване на данни от едно устройство до друго утилизирайки физическия слой.
    Каналният слой може да бъде разделен на два подслоя \textbf{Logical Link Control (LLC)} и \textbf{Media Access Control (MAC)}.\\
    Отговорност на \textbf{DLL} е да предава пакетите до правилните хостове използвайки техните \textbf{MAC} адреси, които се намират използвайки \textbf{ARP (Address Resolution Protocol)}.\\
    Освен това когато пакет от мрежовия слой пристигне той бива допълнително разбит на кадри (frames) в зависимост от размера на кадрите дефиниран от \textbf{NIC (Network Interface Card)}.\\
    Функциите на каналния слой включват:
    \begin{enumerate}
        \item \textit{разбиване на кадри} чрез поставяне на специални битови последователности в началото и края на всеки кадър.
        \item \textit{физическо адресиране} чрез добавяне на \textbf{MAC} адресите на получателя и/или изпращача в хедърите на всеки кадър.
        \item \textit{контрол над грешките} чрез откриване и предаване отново на счупени и/или загубени кадри.
        \item \textit{контрол над потока от данни} - честотата на получаване на устройствата може да бъде различна и заради това се налага координация над количеството от данни, което 
        може да се предава за даден интервал от време.
        \item \textit{контрол на достъпа} - \textbf{MAC} подслоя се използва за да се определи кой има контрол над даден комуникационен канал в някой момент когато той се използва между много устройства.
    \end{enumerate}
    \textbf{DDL} обичайно се предоставя от \textbf{NIC} и някои драйвери на устройства. Имплементира се от \textbf{Ethernet}, суичовете и бриджовете.
    \item \textbf{Мрежовият слой} отговаря за предаването на данни между хостове от различни мрежи, потенциално различаващи се по физическите и каналните си слоеве.
    Като част от този процес е възможно данните да бъдат фрагментирани под формата на пакети \textbf{(PDU (Protocol Data Unit))}.
    Функциите на мрежовия слой включват:
    \begin{enumerate}
        \item \textit{Маршрутизация} - намиране на най-кратък път от изпращач до получател.
        \item \textit{Логическа адресация} - начин за идентификация на всяко устройство в мрежата. При протокола \textbf{IP} адресите на изпращача и получателя биват поставени в хедъра на пакета.
    \end{enumerate}
    Примерни протоколи са \textbf{IP}, \textbf{ICMP} и \textbf{IPSec}.
    \item \textbf{Транспортният слой} отговаря за доставката на цяло съобщение от край-до-край.
    Това се получава като протоколите от този слой разбиват съобщенията получени от сесийния слой на по-малки наречени сегменти и ги препращат към мрежовия слой,
    осигурявайки, че всички части са пристигнали цели и в правилна наредба при получателя. Ако сегмент не е стигнал до дестинацията си, то той бива изпратен отново.
    Казваме, че съобщенията биват доставени от край-до-край защото транспортния слой на изпращача комуникира директно с този на получателя.
    Функциите на транспортния слоя включват:
    \begin{enumerate}
        \item \textit{Сегментация и повторно сглобяване} - транспортния слой на изпращача получава съобщението от сесийния слой, разбива го на сегменти, поставяйки в хедъра на всеки метаданни за реда на реасемблиране и ги подава на мрежовия слой.
        Транспортния слой на получателя се грижи за реасемблирането на пакетите на база техните хедъри.
        \item \textit{Адресация на услуги (Service Point Addressing)} - за да бъде доставено съобщението до правилния процес върху дестинацията, транспортният слой добавя порт на дестинацията в хедърите на всеки сегмент.
    \end{enumerate}
    Транспортният слой се имплементира като част от ОС, правеща системни извиквания към процесите. Примери са \textbf{TCP} и \textbf{UDP}.
    \item \textbf{Сесийният слой} предоставя:
    \begin{enumerate}
        \item \textit{Установяване, поддръжка и терминиране на сесии}
        \item \textit{Синхронизация} - процесите могат да добавят контролни точки в данните чрез периодичното им запазване.
        Така след прекъсвания на предаването и/или грешки се избягва загуба или повреда на данните.
        \item \textit{Диалогов контролер} - процесите могат да комуникират в half-duplex или full-duplex режим, като той следи чий ред е да изпраща данни.
        \item \textit{Сигурност (напр. автентикация)}
    \end{enumerate}
    Обичайно се имплементира чрез сокети.
    \item \textbf{Презентационният слой} извлича и манипулира данните от приложния слой за да станат годни за пренос по мрежата. Той предоставя:
    \begin{enumerate}
        \item \textit{Транслация} - Конвертиране на данновия формат. Например от \textbf{ASCII} към \textbf{EBCDIC}.
        \item \textit{Криптиране/Декриптиране}
        \item \textit{Компресия}
    \end{enumerate}
    Примерни протоколи от презентационния слой са \textbf{TLS}, \textbf{SSL}, \textbf{IMAP} и \textbf{FTP}.
    \item \textbf{Приложният слой} представлява съвкупност от протоколи, които се имплементират директно от процесите. Примери са \textbf{HTTP} и \textbf{DNS}.
\end{enumerate}

\subsection{Съпоставка между моделите OSI и TCP/IP}

Моделът \textbf{TCP/IP} за разлика от \textbf{OSI} се състои от 4 слоя:
\begin{enumerate}
    \item \textbf{Мрежови интерфейс (Network interface)} - обхваща функциите на физическия и каналния слой на \textbf{OSI}.
    \item \textbf{Мрежови слой} - съвпада с мрежовия слой на \textbf{OSI}.
    \item \textbf{Транспортен слой} - съвпада с транспортния слой на \textbf{OSI}.
    \item \textbf{Приложен слой} - обхваща функциите на сесийния, презентационния и приложния слой на \textbf{OSI}.
\end{enumerate}

Следователно и при двата модела има наличие на стек от независими протоколи, като те са със сходни функции.

Основните 3 свойства на \textbf{OSI} са, че дефинира услуги, интерфейси и протоколи. Така всеки слой дефинира услуги и интерфейси, чрез които по-горните слоеве да ги достъпят.
По този начин \textbf{OSI} дефинира какво прави всеки слой, а не как го прави. При \textbf{TCP/IP} няма такова разграничение.

Моделът \textbf{OSI}, за разлика от \textbf{TCP/IP} е измислен преди протоколите, които му принадлежат.
Следователно той е по-абстрактен и позовавайки се на open/closed принципа е по-лесно протоколите от него да бъдат подменени.
За разлика от него \textbf{TCP/IP} е нагоден към конкретни протоколи и не позволява тяхната подмяна.

При \textbf{OSI} транспортния слой е само connection-oriented, докато при \textbf{TCP/IP} е едновременно connectionless и connection-oriented. (мисля, че това е грешно щото и двата включват UDP и TCP в транспортния си слой)

\section{IP}

\subsection{IPv4 адресация – класова и безкласова}

\textbf{IPv4} е протокол от мрежовия слой. Следователно негова задача е да предава успешно пакети от източник до получател без значение дали се намират в една мрежа или не.
Това се постига чрез придаването на IP адрес на всеки хост и рутер в мрежата.

При \textbf{IPv4} адресите са 32-битови, като те се разделят на две части - адрес на мрежата и адрес на хоста в мрежата.
Мрежовият адрес заема префикса на адреса, докато останалите байтове се заделят за адресация на хоста.

В зависимост от структурата си \textbf{IPv4} адресите се разделят на класове. Класовете се характеризират с мрежова маска и фиксиран префикс, като важат следните формули:

$num\_network\_bits = num\_mask\_bits - num\_fixed\_bits$ \\
$num\_networks = 2^{num\_network\_bits}$ \\
$num\_host\_bits = 32 - num\_mask\_bits$ \\
$num\_hosts = 2^{num\_host\_bits} - 2$, защото първият адрес е заделен за мрежовия адрес, а посления за broadcast адреса. \\

В \textbf{IPv4} адресите се делят на следните 5 класа:

\begin{itemize}
    \item \textbf{Клас A} - фиксираният префикс е $\textbf{\textcolor{RubineRed}{0}}$, т.е. обхвата на първия октет е $\textbf{\textcolor{RubineRed}{0}0000001 - \textcolor{RubineRed}{0}1111111}$, т.е. е от $\textbf{1 - 127}$. \\
    Subnet маската на клас A по подразбиране е \textbf{255.0.0.0}.\\
    Клас A включва адресите само от \textbf{1.0.0.0} до \textbf{126.255.255.255}, като \textbf{127.x.x.x} е резервиран за loopback адреса, а \textbf{0.0.0.0} е не-рутируем мета-адрес използван по различен начин в зависимост от контекста, като обичайно е за незнаен или невалиден адрес.\\
    Следователно $num\_networks = 2^7 - 2 = 126$ и $num\_hosts = 2^{24} - 2$.
    \item \textbf{Клас B} - фиксираният префикс е $\textbf{\textcolor{RubineRed}{10}}$, т.е. обхвата на първия октет е $\textbf{\textcolor{RubineRed}{10}000000 - \textcolor{RubineRed}{10}111111}$, т.е. е от $\textbf{128 - 191}$. \\
    Subnet маската на клас B по подразбиране е \textbf{255.255.0.0}.\\
    Клас B включва адресите само от \textbf{128.0.0.0} до \textbf{191.255.255.255}.\\
    Следователно $num\_networks = 2^{14}$ и $num\_hosts = 2^{16} - 2$.
    \item \textbf{Клас C} - фиксираният префикс е $\textbf{\textcolor{RubineRed}{110}}$, т.е. обхвата на първия октет е $\textbf{\textcolor{RubineRed}{110}00000 - \textcolor{RubineRed}{110}11111}$, т.е. е от $\textbf{192 - 223}$. \\
    Subnet маската на клас C по подразбиране е \textbf{255.255.255.0}.\\
    Клас C включва адресите само от \textbf{192.0.0.0} до \textbf{223.255.255.255}.\\
    Следователно $num\_networks = 2^{21}$ и $num\_hosts = 2^{8} - 2$.
    \item \textbf{Клас D} - фиксираният префикс е $\textbf{\textcolor{RubineRed}{1110}}$, т.е. обхвата на първия октет е $\textbf{\textcolor{RubineRed}{1110}0000 - \textcolor{RubineRed}{1110}1111}$, т.е. е от $\textbf{224 - 239}$. \\
    Клас D е резервиран за multicasting и няма subnet маска. \\
    Следователно щом данните при multicasting не са насочени към конкретен хост няма нужда от от извличане на host адреси.
    \item \textbf{Клас D} - фиксираният префикс е $\textbf{\textcolor{RubineRed}{1111}}$ и е резервиран за експериментални дейности в бъдещето. \\
    Обхвата на клас D е $\textbf{240.0.0.0 - 255.255.255.254}$. Той не разполага със subnet маска.
\end{itemize}

Недостатък при $IPv4$ адресацията е, че половината адреси са от клас A и се разпределят между 127 автономни системи.
Всяка мрежа трябва да има уникален номер, което води до проблеми при нарастване броя на мрежите.
Този проблем се разрешава, чрез разцепването на една мрежа на подмрежи, като за целта мрежвия префикс се разширява.

В исторически план се оказва, че класовете A, B и C не са достатъчно гъвкави и те биват заменени чрез \textbf{Classless Inter-Domain Routing (CIDR)}, който включва:
\begin{itemize}
    \item \textbf{Variable-Length Subnet Masking (VLSM)} - мрежови префикси с произволна дължина, като дължината се записва след IP адреса в следния формат \textbf{x.x.x.x/length}.
    Спомага за по-ефективно ползване на изчерпващите се \textbf{IPv4} адреси.
    \item \textbf{Route summarization} - агрегация на множество последователни мрежови префикси в супермрежи (supernets).
    Чрез \textbf{VLSM} се постига обобщаване в супермрежи (supernetting), т.е. съкращаване на префикса, което е обратното деленето на подмрежи (subnetting), т.е. увеличаването на префикса.
\end{itemize}

\subsection{Основни характеристики на протокол IPv6}

\section{TCP}
\subsection{TCP – процедура на трикратно договаряне}
\subsection{Хипертекстов протокол HTTP}

\end{flushleft}
\end{document}
